{% extends "gaza/layout.html" %}
{% load static %}
{% block title %}
 {{ticket}}
{% endblock %}
{% block body %}

<div  class="main-content">
    <div class="page-content">
        <div class="container-fluid">
            <!--Write a comment modal-->
                               
                <!-- Modal -->
                <form action="{% url 'case_management:addComment' %}" class="custom-validation" method="POST">
                    {% csrf_token %}
                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">كتابة رد</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                    
                            <textarea class="form-control" required="" rows="5" name="comment" dir="rtl"></textarea>
                            <input type="hidden" name="theticket" value="{{ticket.id}}">
                        </div>
                        <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إغلاق</button>
                        <button type="submit" class="btn btn-primary">إرسال الرد</button>
                        </div>
                    </div>
                    </div>
                </div>
            </form>





        <div class="row">
            <div class="col-lg-12">
                <div dir="rtl" class="card">
                    <div class="btn-toolbar p-3" role="toolbar">
                  
                     <div class="btn-group me-2 mb-2 mb-sm-0">
                      <form action="{% url 'case_management:CloseCase' %}" method="POST" >
                        {% csrf_token %}
                      <button  name="caseID" value="{{ticket.id}}" aria-expanded="false" class="btn btn-primary waves-light waves-effect " type="submit">
                       إغلاق الشكوى
                      </button>
                        </form>  
                     
                     </div>
                    </div>
                    <div class="card-body">
                        
                        <div class="flex-grow-1 mb-3">
                            <small class="text-muted">
                             {{ticket.date}}
                            </small>
                           </div>
                           <div class="flex-grow-1 mb-3">
                            <small class="text-muted">
                                {{ticket.author.first_name}}
                            </small>
                           </div>

                     <div class="d-flex align-items-start mb-4">
                    
                        
                      <div class="flex-grow-1">
                       <h5 class="font-size-14 my-1">
                        اسم المستفيد: {{ticket.belongsTo}}
                       </h5>
                      
                      </div>
                     </div>
                    
                     <p>
                      {{ticket.content}}
                     </p>
             
                     <hr>
                     <div class="row">

                      <div class="col-xl-2 col-6">
                       <div class="card border shadow-none">
                        <div class="py-2 text-center">
                        {% if ticket.ticketScannedDocs != '' and ticket.ticketScannedDocs != 'False'  %}
                         <a class="fw-medium" href="{{ticket.ticketScannedDocs.url}}" target="_blank">
                          الإطلاع على المرفقات
                         </a>
                         {% else %}
                         لا توجد وثائق مرفقة
                         {% endif %}
                        </div>
                       </div>
                      </div>
                
                     </div>
                     
                     <a  class="btn btn-secondary waves-effect mt-4" data-bs-toggle="modal" data-bs-target="#exampleModal">
                      <i class="mdi mdi-reply">
                      </i>
                      كتابة رد
                     </a>
                    </div>
                   </div>
            </div>
        </div>


        <!-- Comments -->
        {% for comment in comments %}
        <div class="row">
            <div class="col-lg-12">
             <div dir="rtl" class="card">
              <div class="card-body">
               <div class="invoice-title">
                <h4 class="float-end font-size-16">
                 {{comment.author.first_name}}
         
                </h4> <br><br>
             
                <div class="text-muted">
                
                 <p class="mb-1">
                {{comment.date}}
                 </p>
              
                </div>
               </div>
               <hr class="my-4">
          
              <p>
                {{comment.content}}
              </p>
              </div>
             </div>
            </div>
           </div>
           {% endfor %}




        </div>
    </div>
</div>



{% endblock %}